## 목차

# 2장. 데이터 처리의 무엇을, 어디서, 언제, 어떻게

## 배치 처리의 기본: 무엇과 어디서
### 무엇: 변환
고전적인 배치 처리에 적용되는 변환은 
무슨 결과가 계산되는가? 고전적인 배치 처리에 적용되는 변환으로 살펴보자.

2장의 나머지 부분에서 다음 예를 통해 설명할 것이다. 예에서는 사용자의 개별 점수를 합해 팀 점수를 계산한다. 주어진 점수 모두는 같은 팀에 속한 사용자에게서 온 것이다.
```
Name, Team, Score,  EventTime,  ProcTime
---------------------------------------
Julie,	TeamX, 5, T12:00:26, 12:05:19
Ed,	TeamX, 7, T12:02:26, 12:05:39
Amy,	TeamX, 3, T12:03:39, 12:06:13
Fred,	TeamX, 4, T12:04:19, 12:06:39
Julie,	TeamX, 8, T12:03:06, 12:07:06
Naomi,	TeamX, 3, T12:06:39, 12:07:19
Frank,	TeamX, 9, T12:01:26, 12:08:19
Becky,	TeamX, 8, T12:07:26, 12:08:39
Naomi,	TeamX, 1, T12:07:46, 12:09:00
```

시간에 따라 데이터가 어떻게 변화하는지 보이기 위해 9개 점수를 이벤트 시간을 X축으로, 처리 시간을 Y축으로 해 그릴 것이다.

<img src = "http://streamingbook.net/static/images/figures/stsy_0201.png" width="50%" height="50%">

입출력 소스에서 데이터를 읽어 팀/점수 쌍으로 파싱하고, 팀별 점수를 합하는 파이프라인은 다음과 같이 생겼다.

```
// 예. 합계 파이프라인
PCollection<String> raw = IO.read(...); // 가공 전의 데이터
PCollection<KV<String, Integer>> input = raw.apply(new ParseFn());  // 팀 이름의 문자열을 키로, 개별 팀 멤버의 점수인 정수를 값으로 파싱
PCollection<KV<String, Integer>> totals = 
  input.apply(Sum.integersPerKey()) // 변환: 키 단위 합(총 팀 점수)을 계산하기 위해 각 키의 값을 더한다
```
